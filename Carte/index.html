<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
<link rel="stylesheet" href="css/leaflet.css">
<link rel="stylesheet" href="css/L.Control.Layers.Tree.css">
<link rel="stylesheet" href="css/qgis2web.css">
<link rel="stylesheet" href="css/fontawesome-all.min.css">
<link rel="stylesheet" href="css/leaflet-search.css">
<link rel="stylesheet" href="css/leaflet.photon.css">
<link rel="stylesheet" href="css/leaflet-measure.css">
<style>
html, body {
    width: 100%;
    height: 100%;
    margin: 0;
}
#map {
    width: 100%;
    height: 100%;
}
</style>
<title>Carte QGIS2Web</title>
</head>
<body>
<div id="map"></div>

<script src="js/leaflet.js"></script>
<script src="js/L.Control.Layers.Tree.min.js"></script>
<script src="js/leaflet.rotatedMarker.js"></script>
<script src="js/leaflet.pattern.js"></script>
<script src="js/leaflet-hash.js"></script>
<script src="js/Autolinker.min.js"></script>
<script src="js/rbush.min.js"></script>
<script src="js/labelgun.min.js"></script>
<script src="js/labels.js"></script>
<script src="js/leaflet.photon.js"></script>
<script src="js/leaflet-measure.js"></script>

<!-- GeoJSON data -->
<script src="data/OccupationduSol_0.js"></script>
<script src="data/Hydrographie_1.js"></script>
<script src="data/Routes_Lefini_2.js"></script>
<script src="data/Localite_reserve_Lefini2_3.js"></script>

<script>
// === Création de la carte sans OSM au départ ===
var map = L.map('map', {
    zoomControl: true,
    maxZoom: 28,
    minZoom: 1
}).fitBounds([[-2.9697130610141493,15.336594752411493],[-2.322205108349378,16.28627308298649]]);

// === Création des panes GeoJSON avec z-index > OSM ===
map.createPane('pane_OccupationduSol_0'); 
map.getPane('pane_OccupationduSol_0').style.zIndex = 400;

map.createPane('pane_Hydrographie_1');
map.getPane('pane_Hydrographie_1').style.zIndex = 401;

map.createPane('pane_Routes_Lefini_2');
map.getPane('pane_Routes_Lefini_2').style.zIndex = 402;

map.createPane('pane_Localite_reserve_Lefini2_3');
map.getPane('pane_Localite_reserve_Lefini2_3').style.zIndex = 403;

// === Ajout des couches GeoJSON ===
// (Tes fonctions style_X et pop_X sont identiques à celles de ton code d'origine)
var layer_OccupationduSol_0 = new L.geoJson(json_OccupationduSol_0, {
    pane: 'pane_OccupationduSol_0',
    onEachFeature: pop_OccupationduSol_0,
    style: style_OccupationduSol_0_0
}).addTo(map);

var layer_Hydrographie_1 = new L.geoJson(json_Hydrographie_1, {
    pane: 'pane_Hydrographie_1',
    onEachFeature: pop_Hydrographie_1,
    style: style_Hydrographie_1_0
}).addTo(map);

var layer_Routes_Lefini_2 = new L.geoJson(json_Routes_Lefini_2, {
    pane: 'pane_Routes_Lefini_2',
    onEachFeature: pop_Routes_Lefini_2,
    style: style_Routes_Lefini_2_0
}).addTo(map);

var layer_Localite_reserve_Lefini2_3 = new L.geoJson(json_Localite_reserve_Lefini2_3, {
    pane: 'pane_Localite_reserve_Lefini2_3',
    onEachFeature: pop_Localite_reserve_Lefini2_3,
    pointToLayer: function(feature, latlng) {
        return L.circleMarker(latlng, style_Localite_reserve_Lefini2_3_0(feature));
    }
}).addTo(map);

// === Ajout du fond OpenStreetMap après les panes ===
var osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19,
    attribution: '© OpenStreetMap contributors'
}).addTo(map);

// === Contrôle des couches ===
var baseMaps = { "OpenStreetMap": osm };
var overlayMaps = {
    "Occupation du sol": layer_OccupationduSol_0,
    "Hydrographie": layer_Hydrographie_1,
    "Routes": layer_Routes_Lefini_2,
    "Villes": layer_Localite_reserve_Lefini2_3
};
L.control.layers(baseMaps, overlayMaps, {collapsed: false}).addTo(map);

// === Contrôle Zoom, Mesure, Hash, Photon etc. ===
// (Copier les scripts que tu avais pour photon, mesure et hash ici)

// === Layer Tree ===
// (Copier ton overlaysTree et L.control.layers.tree ici)

// === Reset labels et events ===
// (Copier tes scripts resetLabels et événements zoom/layeradd/layerremove ici)
</script>
</body>
</html>
