<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
<title>Test Carto</title>
<link rel="stylesheet" href="css/leaflet.css">
<link rel="stylesheet" href="css/L.Control.Layers.Tree.css">
<link rel="stylesheet" href="css/qgis2web.css">
<link rel="stylesheet" href="css/fontawesome-all.min.css">
<style>
html, body { width: 100%; height: 100%; margin: 0; }
#map { width: 100%; height: 100%; }
</style>
</head>
<body>
<div id="map"></div>

<script src="js/leaflet.js"></script>
<script src="js/L.Control.Layers.Tree.min.js"></script>
<script src="js/leaflet.rotatedMarker.js"></script>
<script src="js/leaflet.pattern.js"></script>
<script src="js/leaflet-hash.js"></script>

<!-- Vos données GeoJSON -->
<script src="data/OccupationduSol_0.js"></script>
<script src="data/Hydrographie_1.js"></script>
<script src="data/Routes_Lefini_2.js"></script>
<script src="data/Localite_reserve_Lefini2_3.js"></script>

<script>
/* ------------------------ */
/* 1. Créer la carte       */
/* ------------------------ */
var osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19,
    attribution: '© OpenStreetMap contributors'
});

var map = L.map('map', {
    zoomControl: true,
    layers: [osm]
}).fitBounds([[-2.9697130610141493,15.336594752411493],[-2.322205108349378,16.28627308298649]]);

/* ------------------------ */
/* 2. Créer les panes       */
/* ------------------------ */
var panes = [
    {name: 'OccupationduSol_0', z: 400},
    {name: 'Hydrographie_1', z: 401},
    {name: 'Routes_Lefini_2', z: 402},
    {name: 'Localite_reserve_Lefini2_3', z: 403}
];
panes.forEach(function(p){
    map.createPane(p.name);
    map.getPane(p.name).style.zIndex = p.z;
    map.getPane(p.name).style['mix-blend-mode'] = 'normal';
});

/* ------------------------ */
/* 3. Ajouter les couches   */
/* ------------------------ */
var layer_OccupationduSol_0 = L.geoJson(json_OccupationduSol_0, {
    pane: 'OccupationduSol_0',
    style: function(feature){ /* Simplifié ici, vous pouvez remettre vos styles */ return {color:'green', fillOpacity:0.7, weight:1}; },
    onEachFeature: function(feature, layer){ layer.bindPopup(feature.properties.Type || ""); }
}).addTo(map);

var layer_Hydrographie_1 = L.geoJson(json_Hydrographie_1, {
    pane: 'Hydrographie_1',
    style: function(feature){ return {color:'blue', weight:2}; },
    onEachFeature: function(feature, layer){ layer.bindPopup(feature.properties.Type || ""); }
}).addTo(map);

var layer_Routes_Lefini_2 = L.geoJson(json_Routes_Lefini_2, {
    pane: 'Routes_Lefini_2',
    style: function(feature){ return {color:'red', weight:2}; },
    onEachFeature: function(feature, layer){ layer.bindPopup(feature.properties.Nom || ""); }
}).addTo(map);

var layer_Localite_reserve_Lefini2_3 = L.geoJson(json_Localite_reserve_Lefini2_3, {
    pane: 'Localite_reserve_Lefini2_3',
    pointToLayer: function(feature, latlng){ return L.circleMarker(latlng, {radius:4, fillColor:'black', color:'black', weight:1, fillOpacity:1}); },
    onEachFeature: function(feature, layer){ layer.bindPopup(feature.properties.Toponyme || ""); }
}).addTo(map);

/* ------------------------ */
/* 4. Contrôle des couches  */
/* ------------------------ */
var baseMaps = { "OpenStreetMap": osm };
var overlayMaps = {
    "Occupation du sol": layer_OccupationduSol_0,
    "Hydrographie": layer_Hydrographie_1,
    "Routes": layer_Routes_Lefini_2,
    "Villes": layer_Localite_reserve_Lefini2_3
};
L.control.layers(baseMaps, overlayMaps, {collapsed: false}).addTo(map);

/* ------------------------ */
/* 5. Légende simple        */
/* ------------------------ */
var legend = L.control({position: 'bottomright'});
legend.onAdd = function (map) {
    var div = L.DomUtil.create('div', 'info legend');
    div.innerHTML = "<b>Légende</b><br>Occupation du sol: vert<br>Hydrographie: bleu<br>Routes: rouge<br>Villes: noir";
    return div;
};
legend.addTo(map);
</script>
</body>
</html>
